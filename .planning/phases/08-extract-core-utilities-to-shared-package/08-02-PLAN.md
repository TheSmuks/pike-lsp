---
phase: 08-extract-core-utilities-to-shared-package
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified: [
  packages/pike-bridge/package.json,
  packages/pike-bridge/src/process.ts,
  packages/pike-bridge/src/bridge.ts,
  packages/pike-bridge/src/errors.ts,
  packages/pike-bridge/src/logging.ts
]
autonomous: true

must_haves:
  truths:
    - "pike-bridge imports Logger and Errors from @pike-lsp/core"
    - "Local duplicate files removed from pike-bridge/src/"
    - "Bridge unit tests pass using extracted utilities"
  artifacts:
    - path: "packages/pike-bridge/package.json"
      provides: "Workspace dependency on @pike-lsp/core"
  key_links:
    - from: "packages/pike-bridge/src/bridge.ts"
      to: "@pike-lsp/core"
      via: "import { Logger } from '@pike-lsp/core'"
---

<objective>
Migrate @pike-lsp/pike-bridge to use the shared core package and remove duplicate code.

Purpose: Reduce code duplication and verify shared package consumption.
Output: Refactored pike-bridge using shared utilities.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/08-extract-core-utilities-to-shared-package/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add workspace dependency</name>
  <files>packages/pike-bridge/package.json</files>
  <action>
    Add "@pike-lsp/core": "workspace:*" to dependencies in packages/pike-bridge/package.json.
    Run pnpm install from root to link packages.
  </action>
  <verify>grep "@pike-lsp/core" packages/pike-bridge/package.json</verify>
  <done>Bridge package can now resolve core utilities.</done>
</task>

<task type="auto">
  <name>Task 2: Update imports and remove duplicates</name>
  <files>packages/pike-bridge/src/process.ts, packages/pike-bridge/src/bridge.ts, packages/pike-bridge/src/errors.ts, packages/pike-bridge/src/logging.ts</files>
  <action>
    In bridge.ts and process.ts (and any tests), update imports from './errors.js' and './logging.js' to '@pike-lsp/core'.
    Delete packages/pike-bridge/src/errors.ts and packages/pike-bridge/src/logging.ts.
  </action>
  <verify>! test -f packages/pike-bridge/src/errors.ts</verify>
  <done>Code duplication removed from bridge package.</done>
</task>

<task type="auto">
  <name>Task 3: Verify bridge functionality</name>
  <files>packages/pike-bridge/dist/bridge.js</files>
  <action>
    Run pnpm build and pnpm test in packages/pike-bridge.
    Ensure all tests pass with the extracted utilities.
  </action>
  <verify>cd packages/pike-bridge && pnpm test</verify>
  <done>Bridge refactor verified and functional.</done>
</task>

</tasks>

<verification>
Run `grep -r "./errors.js" packages/pike-bridge/src/` to ensure no local imports remain.
Run unit tests to ensure behavior is preserved.
</verification>

<success_criteria>
pike-bridge no longer maintains its own Logger or Error classes.
</success_criteria>

<output>
After completion, create `.planning/phases/08-extract-core-utilities-to-shared-package/08-02-SUMMARY.md`
</output>
